# 変更仕様書

## 現状の実装

~/src/run.pyは二つのファイルを作成します
一つは~/doc/yyyy-mm-dd-topic.mdを作成します
これはMarpでスライドショーを作成するためのmarkdownです
もう一つはpodcast投稿用で~/_posts/yyyy-dd-mm-index.mdです
これは、podcastに投稿するfeedを作るベースのページになり、github pagesで投稿されます

run.pyは~/src/topic.yamlにある内容をもとに二つのファイルを作りますがほぼほぼ静的に作ります

## 変更仕様

新しいtopic.yamlの仕様に基づき、[Perplexity API](https://docs.perplexity.ai/api-reference/chat-completions)で情報を収集し、生成AIによって二つのファイルを作るようにします

### ~/src/.env

ANTHROPIC_API_KEY=生成AIのANTHROPICモデルを使うためのAPIキー。モデルはclaude-3-5-sonnet-20241022のみを利用する
PERPLEXITY_API_KEY=検索用のPerplexity APIを使うためのAPIキー。モデルはsonar-proのみを利用する

### ~/src/topic.yaml

以下の仕様に変更します

```yaml
Date: 2025-01-18
Topic:
  - https://news-page1.com
  - https://news-page2.com
  - https://news-page3.com
  - https://news-page4.com
  - https://news-page5.com
  - https://news-page6.com
```

Date: ポッドキャストをする日
Topic: ポッドキャストで話すネタ元のニュース記事URL

### ~/doc/yyyy-mm-dd-topic.md

以下をループしてファイルを生成する
1. topic.yamlからリンクを取得する
2. PERPLEXITY APIを使って該当リンクに対する情報を取得する
3. 生成AIで見出しを10～20文字にまとめる

最後に全体を通して最も大きなニュースと判断されるものを一つピックアップしタイトルを10～20文字で作成する

Topicのリンク数は動的に変わるため、ループ回数はtopic.yamlファイルに依存することに注意してください


#### 期待する生成結果

```md
---
marp: true
theme: myformat
paginate: true
---

<!--
_class: normal
-->

![bg](./stringarea.png)
# 生成されたタイトル

## 01. 生成された記事の見出し1
### 02. 生成された記事の見出し2
### 03. 生成された記事の見出し3
### 04. 生成された記事の見出し4
### 05. 生成された記事の見出し5
### 06. 生成された記事の見出し6
---

<!--
_class: normal
-->

![bg](./stringarea.png)
# 生成されたタイトル

### 01. 生成された記事の見出し1
## 02. 生成された記事の見出し2
### 03. 生成された記事の見出し3
### 04. 生成された記事の見出し4
### 05. 生成された記事の見出し5
### 06. 生成された記事の見出し6
---

<!--
_class: normal
-->

![bg](./stringarea.png)
# 生成されたタイトル

### 01. 生成された記事の見出し1
### 02. 生成された記事の見出し2
## 03. 生成された記事の見出し3
### 04. 生成された記事の見出し4
### 05. 生成された記事の見出し5
### 06. 生成された記事の見出し6
---

<!--
_class: normal
-->

![bg](./stringarea.png)
# 生成されたタイトル

### 01. 生成された記事の見出し1
### 02. 生成された記事の見出し2
### 03. 生成された記事の見出し3
## 04. 生成された記事の見出し4
### 05. 生成された記事の見出し5
### 06. 生成された記事の見出し6
---

<!--
_class: normal
-->

![bg](./stringarea.png)
# 生成されたタイトル

### 01. 生成された記事の見出し1
### 02. 生成された記事の見出し2
### 03. 生成された記事の見出し3
### 04. 生成された記事の見出し4
## 05. 生成された記事の見出し5
### 06. 生成された記事の見出し6
---

<!--
_class: normal
-->

![bg](./stringarea.png)
# 生成されたタイトル

### 01. 生成された記事の見出し1
### 02. 生成された記事の見出し2
### 03. 生成された記事の見出し3
### 04. 生成された記事の見出し4
### 05. 生成された記事の見出し5
## 06. 生成された記事の見出し6

```

### ~/doc/yyyy-mm-dd-topic.md

以下をループしてファイルを生成する
1. topic.yamlからリンクを取得する
2. PERPLEXITY APIを使って該当リンクに対する情報を取得する
3. 生成AIで見出しを10～20文字にまとめる
4. 生清AIで記事の内容を250文字から350文字にまとめる

最後に全体を通して最も大きなニュースと判断されるものを一つピックアップしタイトルを10～20文字で作成する

Topicのリンク数は動的に変わるため、ループ回数はtopic.yamlファイルに依存することに注意してください


#### 期待する生成結果

```md
---
actor_ids:
- kokorokagami
- touden
audio_file_path: /audio/yyyymmddm.mp3
audio_file_size: 0
date: yyyy-mm-dd 20:00:00 +0900
description: kokorokagamiとtoudenの2人で、生成された記事の見出し1、生成された記事の見出し2 など について話しました。
duration: "00:00"
layout: article
title: index. yyyy/mm/dd 生成されたタイトル
---

以下のようなトピックについて話をしました。

## 01. 生成された記事の見出し1

生成された記事の要約1

## 02. 生成された記事の見出し2

生成された記事の要約2

## 03. 生成された記事の見出し3

生成された記事の要約3

## 04. 生成された記事の見出し4

生成された記事の要約4

## 05. 生成された記事の見出し5

生成された記事の要約5

## 06. 生成された記事の見出し6

生成された記事の要約6


___

本ラジオはあくまで個人の見解であり現実のいかなる団体を代表するものではありません  
ご理解頂ますようよろしくおねがいします  

```
